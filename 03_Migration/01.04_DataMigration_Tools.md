# Data Migration with 3rd Party Tools

## Setup

Follow all the steps in the [Setup](./../05_Appendix/00_Setup.md) guide to create an environment to support the following steps.

> **Note** If the source server is not enabled for SSL and is running 6.0 or higher, it is highly recommended that it is enabled and configured.  See [Configure Redis for SSL connectivity](../05_Appendix/04_ConfigurePostgresSSL.md) to enable SSL for the instance.

## Install STunnel

- TODO

## Redis-migrate

- https://github.com/vipshop/redis-migrate-tool

- Download the source and compile the tool by running the following:

```bash
sudo apt-get install git-all
sudo apt-get install automake libtool autoconf bzip2

git clone https://github.com/vipshop/redis-migrate-tool

cd redis-migrate-tool
autoreconf -fvi
./configure
make
```

- Create a migration configuration file call `migrate.conf`
- Run the following:

```bash
sudo nano migrate.conf
```

- Copy the following into it, be sure to replace the target REdis instance name, port and password:

```text
[source]
type: single
servers:
 - 127.0.0.1:6379

[target]
type: single
redis_auth: <REDIS_PWD>
servers:
 - <REDIS_NAME>.redis.cache.windows.net:6379:1 server1

[common]
listen: 0.0.0.0:8888
threads: 2
step: 1
mbuf_size: 1024
source_safe: true
```

- To use the tool, run the following:

```bash
./src/redis-migrate-tool -c migrate.conf -o log -d
```

- Check the status of the tool:

```bash
redis-cli -h 127.0.0.1 -p 8888
```

- Check that data in the source and target:

```bash
./src/redis-migrate-tool -c migrate.conf -o log -C redis_check
```

- Run a test insert

```bash
./src/redis-migrate-tool -c migrate.conf -o log -C "redis_testinsert"
```

## redis-copy

- Switch to the **win10** virtual machine
- Open a PowerShell window, run the following:

```PowerShell
git clone https://github.com/deepakverma/redis-copy
```

- Open the `` solution file
- Update the configuration file
- Press **F5** to run the tool

## redis-dump

- On the target server, run the following to install the tool:

```bash
sudo apt-get install ruby ruby-dev

gem install redis-dump -V
```

- Run the following to run the tool:

```bash
```

## Resources

- https://github.com/vipshop/redis-migrate-tool
- https://github.com/deepakverma/redis-copy