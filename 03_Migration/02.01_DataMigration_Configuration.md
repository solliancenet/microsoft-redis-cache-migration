# Data Migration - Configuration

## Configuration

It is possible that you may want to keep your source instance configuration settings and move them over to Azure Cache for Redis.

### Export the configuration

- Run the following to export any valuable configuration details

```bash
TODO
```

- Items to consider
  - Persistence type
  - Cache Eviction policy

### Export Users and Roles (6.x or higher)

If you are using Redis version 6.x or higher, you may have created ACL rules that will need to be migrated.

- Run the following to export all users and ACLs

```PowerShell
$users = redis-cli ACL LIST

foreach($user in $users)
{
    $vals = $user.split(" ");

    $user = $vals[1];

    foreach($val in $vals)
    {
        if ($val.startswith("#"))
        {
            $hashPwd = $val;
        }

        if ($val.startswith("~"))
        {
            $keys = $val;
        }

        if ($val.startswith("&"))
        {
            $channels = $val;
        }

        if ($val.startswith("+"))
        {
            $commands = $val;
        }
    }

    $line = $user + "`t" + $keys + "`t" + $commands + "`t" + $hashPwd + "`t"

    add-content "users.txt" $user;
}
```

- Import into the target instance

```PowerShell
$lines = get-content "users.txt"


foreach($line in $lines)
{
    $vals = $line.split("`t");

    #parse the values
    $user = $vals[0];
    $hashPwd = $vals[3];
    $keys = $vals[1];
    $commands = $vals[2];

    redis-cli ACL SETUSER $user on $keys +$commands `#$hashPwd
}
```

After running through the previous series of steps, the migration of the source configuration to the target will be completed.
